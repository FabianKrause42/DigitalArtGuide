<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" sizes="192x192" href="/images/icons/logo-192.png">
  <meta name="theme-color" content="#F2F2F2">
  <link rel="manifest" href="manifest.json?v=20260212.0900">
  <title>Galerie Stadt Sindelfingen</title>
  <link rel="stylesheet" href="css/styles.css?v=20260212.0900">
</head>
<body>
  <!-- Zentrale Tab-Navigation (nicht animiert) -->
  <nav class="tab-navigation">
    <button class="tab-button active" data-screen="home" aria-label="Ausstellungen">
      <img src="images/icons/home.png" alt="Home">
      <span>Ausstellungen</span>
    </button>
    <button class="tab-button" data-screen="scan" aria-label="Scannen">
      <img src="images/icons/camera.png" alt="Scannen">
      <span>Scannen</span>
    </button>
    <button class="tab-button" data-screen="number" aria-label="Nummer">
      <img src="images/icons/number2.png" alt="Nummer">
      <span>Nummer</span>
    </button>
    <button class="tab-button" data-screen="map-overview" aria-label="Lageplan">
      <img src="images/icons/map.png" alt="Karte">
      <span>Lageplan</span>
    </button>
  </nav>

  <!-- Screen Container: Dynamisch gefüllt durch content-loader.js -->
  <div class="screens-container">
    <!-- Der aktuelle Screen wird hier eingefügt -->
    <div class="screen active" id="currentScreen"></div>
  </div>

  <!-- TensorFlow.js Library (muss vor recognition.js geladen werden) -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0"></script>
  
  <!-- Navigation: ImageSliderController Klasse (muss VOR content-loader geladen werden) -->
  <script src="js/navigation.js?v=20260213.1400"></script>
  
  <!-- Number Input Controller -->
  <script src="js/number-input.js?v=20260212.0900"></script>
  
  <!-- Artworks List Controller -->
  <script src="js/artworks-list-controller.js?v=20260213.1400"></script>
  
  <!-- Artwork Detail Controller -->
  <script src="js/artwork-detail-controller.js?v=20260218.1510"></script>
  
  <!-- Audio Player Component -->
  <script src="js/audio-player.js?v=20260218.1605"></script>
  
  <!-- Map Navigation Controller -->
  <script src="js/map-navigation.js?v=20260220.1200"></script>
  
  <!-- Content Loader: Lädt Screens dynamisch und handhabt Animationen -->
  <script src="js/content-loader.js?v=20260218.1520"></script>
  
  <!-- ML Kunstwerk-Erkennung -->
  <script src="recognition.js?v=20260212.0900"></script>

  <!-- Service Worker Registrierung für PWA -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').then((registration) => {
          console.log('Service Worker registriert:', registration);
          
          // Prüfe auf Updates alle 60 Sekunden
          setInterval(() => {
            registration.update();
          }, 60000);
          
          // Wenn neuer Service Worker wartet, aktiviere ihn sofort
          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            newWorker.addEventListener('statechange', () => {
              if (newWorker.state === 'activated' && navigator.serviceWorker.controller) {
                console.log('Neue Version verfügbar - Seite wird neu geladen...');
                window.location.reload();
              }
            });
          });
        }).catch((error) => {
          console.error('Service Worker Registrierung fehlgeschlagen:', error);
        });
        
        // Listener für Controller-Wechsel (neuer SW übernimmt)
        navigator.serviceWorker.addEventListener('controllerchange', () => {
          console.log('Service Worker aktualisiert - Seite wird neu geladen');
          window.location.reload();
        });
      });
    }
  </script>
</body>
</html>
